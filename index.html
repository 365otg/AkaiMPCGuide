<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The MPC Guide: Ultimate Edition</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Master your AKAI MPC with this comprehensive guide. Explore over 370 essential tips, advanced techniques, workflow hacks, and AI-powered suggestions for sampling, effects, patterns, sequencing, mixing, and more. Your ultimate resource for the MPC Standalone OS.">
    <meta name="keywords" content="AKAI MPC, MPC Live, MPC One, MPC X, MPC Key, MPC Standalone, MPC OS, MPC Guide, MPC Tutorial, MPC Tips, MPC Tricks, Sampling, Effects, Sequencing, Drum Machine, Beatmaking, Hip Hop Production, Lofi, Workflow, Automation, Q-Links, MIDI, CV, Ableton Link, Serato, Troubleshooting, The MPC Guide, Ultimate Guide">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --akai-dark: #1A1A1D;
            --akai-card-bg: #1E1E1E;
            --akai-accent: #FF4500;
            --akai-accent-hover: #FF6347;
            --akai-muted: #4A4A50;
            --akai-muted-hover: #5A5A60;
            --akai-text-light: #E0E0E0;
            --akai-text-dark: #A0A0A0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--akai-dark);
            color: var(--akai-text-light);
            padding-top: 4rem;
            padding-bottom: 4rem;
            background-image: linear-gradient(135deg, #101012 0%, #1A1A1D 100%);
            background-size: 200% 200%;
            animation: gradient-animation 15s ease infinite;
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .card {
            background-color: var(--akai-card-bg);
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.5);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .card:hover {
            transform: translateY(-7px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
        }
        .tip-category-button, .difficulty-sort-button, .header-button {
            background-color: var(--akai-muted);
            color: #ffffff;
            padding: 14px 28px; /* Increased padding for bigger buttons */
            border-radius: 12px;
            font-weight: 600;
            letter-spacing: 0.08em;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .tip-category-button:hover, .difficulty-sort-button:hover, .header-button:hover {
            background-color: var(--akai-muted-hover);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        .tip-category-button.active, .difficulty-sort-button.active {
            background-color: var(--akai-accent);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
        }
        .tip-item {
            background-color: #2A2A30;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid var(--akai-accent);
        }
        .modal {
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 50;
        }
        .modal-content {
            background-color: var(--akai-card-bg);
            border-radius: 16px;
        }
        .close-button {
            color: #F0F0F0;
            font-size: 1.8rem;
            transition: color 0.2s;
        }
        .close-button:hover {
            color: #FF8888;
        }
        .search-input {
            background-color: var(--akai-dark);
            border: 1px solid var(--akai-muted);
            color: #F0F0F0;
            padding: 14px 20px;
            border-radius: 10px;
            outline: none;
            width: 100%;
            max-width: 450px;
        }
        .search-input::placeholder {
            color: var(--akai-text-dark);
        }
        .search-button, #download-pdf-button, .donate-button, .more-info-button, #back-to-tip-button {
            background-color: var(--akai-accent);
            color: #ffffff;
            padding: 12px 22px;
            border-radius: 10px;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: none;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .search-button:hover, #download-pdf-button:hover, .donate-button:hover, .more-info-button:hover, #back-to-tip-button:hover {
            background-color: var(--akai-accent-hover);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        .related-tips-container, .glossary-item, .suggested-tip-container, #details-glossary-container {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--akai-muted);
        }
        .suggested-tip-box {
            background-color: #252525;
            border: 1px solid var(--akai-muted);
            border-left: 5px solid var(--akai-accent);
            padding: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .suggested-tip-box:hover {
            background-color: #333;
        }
        .tip-icon {
            margin-right: 12px;
            color: var(--akai-accent);
            font-size: 1.1em;
        }
        .copy-button {
            background-color: var(--akai-muted);
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 500;
            transition: background-color 0.2s ease-in-out;
            margin-top: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        .copy-button:hover {
            background-color: var(--akai-muted-hover);
        }
        .difficulty-badge {
            display: inline-block;
            padding: 0.25em 0.6em;
            font-size: 0.75em;
            font-weight: 700;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 0.375rem;
        }
        .difficulty-easy { color: #1f2937; background-color: #6ee7b7; }
        .difficulty-intermediate { color: #1f2937; background-color: #fde047; }
        .difficulty-hard { color: #f9fafb; background-color: #f87171; }
        .details-view { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        footer { border-top: 1px solid var(--akai-muted); padding-top: 2rem; margin-top: 4rem; }
        .footer-link { transition: color 0.2s ease-in-out; color: var(--akai-text-dark); }
        .footer-link:hover { color: var(--akai-accent); }
        h1, h2, h3, h4 { color: var(--akai-text-light); }
        p, li { color: #b0b0b0; }
        #modal-title, #details-title, #glossary-modal h3 { color: var(--akai-text-light); }
        #modal-description, #modal-source, #details-content, #glossary-content p, #related-tips-list li { color: #b0b0b0; }
        .main-title {
            background: -webkit-linear-gradient(45deg, #FFD700, #FF4500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .drum-pattern-grid {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 4px;
            background-color: #252525;
            padding: 8px;
            border-radius: 8px;
            margin-top: 0.5rem;
        }
        .drum-step {
            width: 100%;
            padding-bottom: 100%; /* Aspect ratio 1:1 */
            background-color: #4A4A50;
            border-radius: 4px;
        }
        .drum-step.active {
            background-color: var(--akai-accent);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center px-4">

    <header class="w-full max-w-6xl text-center mb-12">
        <div class="flex justify-between items-center mb-6">
            <button id="mpc-sauce-button" class="header-button"><i class="fa-solid fa-pepper-hot mr-2"></i>MPC Sauce</button>
            <h1 class="text-6xl font-bold main-title mb-6">The MPC Guide: Ultimate Edition</h1>
            <button id="glossary-button" class="header-button"><i class="fas fa-book mr-2"></i>Glossary</button>
        </div>
        <p class="text-2xl text-gray-300">Unlock the full potential of your AKAI MPC!</p>
    </header>

    <main class="w-full max-w-6xl">
        <div class="flex flex-col sm:flex-row justify-center items-center mb-12 gap-4">
            <input type="search" id="search-input" placeholder="Search over 370 tips..." class="search-input">
            <button id="search-button" class="search-button">Search</button>
        </div>

        <!-- Featured Techniques Section -->
        <section class="mb-16 p-6 featured-section rounded-lg">
             <div id="top-tips-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Featured tips will be dynamically loaded here -->
            </div>
        </section>

        <!-- Filters -->
        <div class="mb-12">
            <h3 class="text-2xl font-bold text-center mb-6">Filter by Category</h3>
            <div id="category-filter-container" class="flex flex-wrap justify-center gap-4">
                <!-- Category buttons will be dynamically loaded here -->
            </div>
        </div>
        
        <div id="difficulty-filter-container" class="flex flex-wrap justify-center gap-4 mb-16">
            <button class="difficulty-sort-button active" data-difficulty="all">All Difficulties</button>
            <button class="difficulty-sort-button" data-difficulty="Easy">Easy</button>
            <button class="difficulty-sort-button" data-difficulty="Intermediate">Intermediate</button>
            <button class="difficulty-sort-button" data-difficulty="Hard">Hard</button>
        </div>

        <section id="tips-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
            <!-- Tips will be loaded here by JavaScript -->
        </section>
        
        <div class="flex justify-center mt-16">
            <button id="download-pdf-button" class="search-button"><i class="fa-solid fa-file-pdf"></i> Download All Tips as PDF</button>
        </div>
    </main>

      <!-- Tip Modal -->
    <div id="tip-modal" class="modal fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="modal-content w-full max-w-2xl p-8 relative overflow-y-auto max-h-[90vh]">
            <button id="close-modal" class="close-button absolute top-4 right-4 z-10">&times;</button>
            
            <!-- Main Tip View -->
            <div id="main-tip-view">
                <h3 id="modal-title" class="text-3xl font-semibold mb-2"></h3>
                <p id="modal-category" class="text-lg text-gray-400 mb-6"></p>
                <p id="modal-description" class="text-lg leading-relaxed"></p>
                <p id="modal-source" class="text-sm mt-6"></p>

                <div class="flex flex-wrap gap-2 mt-4">
                    <button id="copy-tip-button" class="copy-button"><i class="fa-solid fa-copy"></i> Copy Tip</button>
                    <button id="more-info-button" class="more-info-button"><i class="fa-solid fa-circle-info"></i> More Info</button>
                </div>
                
                <div id="suggested-tip-container" class="suggested-tip-container hidden">
                     <h4 class="text-2xl font-semibold mb-4">You might also like...</h4>
                     <div id="suggested-tip-box" class="suggested-tip-box">
                         <!-- Suggested tip content goes here -->
                     </div>
                </div>
            </div>

            <!-- Detailed Explanation View -->
            <div id="details-view" class="hidden">
                 <h3 id="details-title" class="text-3xl font-semibold mb-2"></h3>
                 <p id="details-category" class="text-lg text-gray-400 mb-6"></p>
                 <div id="details-content" class="text-lg leading-relaxed prose prose-invert max-w-none"></div>
                 
                 <div id="details-related-container" class="related-tips-container">
                     <h4 class="text-2xl font-semibold mb-4">Related Tips</h4>
                     <ul id="details-related-list" class="list-disc list-inside"></ul>
                 </div>

                 <div id="details-glossary-container">
                    <h4 class="text-2xl font-semibold mb-4">Relevant Glossary Terms</h4>
                    <div id="details-glossary-list"></div>
                 </div>

                 <button id="back-to-tip-button" class="search-button mt-6"><i class="fa-solid fa-arrow-left"></i> Back</button>
            </div>
        </div>
    </div>
    
    <!-- Glossary Modal -->
    <div id="glossary-modal" class="modal fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="modal-content w-full max-w-2xl p-8 relative overflow-y-auto max-h-[90vh]">
            <button id="close-glossary-modal" class="close-button absolute top-4 right-4 z-10">&times;</button>
            <h3 class="text-4xl font-semibold mb-6">Glossary</h3>
            <input type="search" id="glossary-search-input" placeholder="Search terms..." class="search-input mb-6 w-full">
            <div id="glossary-content" class="text-lg leading-relaxed"></div>
        </div>
    </div>

    <!-- MPC Sauce Modal -->
    <div id="mpc-sauce-modal" class="modal fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="modal-content w-full max-w-3xl p-8 relative overflow-y-auto max-h-[90vh]">
            <button id="close-mpc-sauce-modal" class="close-button absolute top-4 right-4 z-10">&times;</button>
            <h3 class="text-4xl font-semibold mb-6"><i class="fa-solid fa-pepper-hot mr-3"></i>MPC Sauce</h3>
            <div id="mpc-sauce-content" class="text-lg leading-relaxed">
                <!-- Music Theory Section -->
                <div class="mb-8">
                    <h4 class="text-2xl font-bold mb-4 border-b-2 border-akai-accent pb-2">Music Theory for Beatmakers</h4>
                    <p class="mb-2"><strong>Minor Pentatonic Scale:</strong> The cheat code for soulful melodies. For C Minor Pentatonic, play these notes: C, Eb, F, G, Bb. It works over almost any minor chord progression.</p>
                    <p class="mb-2"><strong>The 2-5-1 Progression:</strong> A cornerstone of Jazz, R&B, and Lofi. In C Major, the chords are D minor 7, G dominant 7, and C Major 7. Perfect for smooth, looping chord changes.</p>
                    <p><strong>Finding the Key:</strong> Use Pad Perform > Scales to lock your pads to a specific key. This ensures every note you play sounds good together. A great starting point is C Minor.</p>
                </div>

                <!-- Drum Patterns Section -->
                <div>
                    <h4 class="text-2xl font-bold mb-4 border-b-2 border-akai-accent pb-2">Iconic & Foundational Drum Patterns</h4>
                    <div id="drum-patterns-container">
                        <!-- Drum patterns will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="w-full max-w-6xl text-center text-gray-500">
        <p class="mb-4">Built by <a href="https://365otg.github.io/365CP/" target="_blank" class="font-bold footer-link">Charles A Paris</a></p>
        <div class="flex justify-center items-center gap-6 text-2xl">
            <a href="https://twitter.com/365charlesparis" target="_blank" class="footer-link"><i class="fab fa-twitter"></i></a>
            <a href="https://youtube.com/365charlesparis" target="_blank" class="footer-link"><i class="fab fa-youtube"></i></a>
            <a href="https://paypal.me/overtimegrind" target="_blank" class="donate-button text-sm"><i class="fas fa-heart mr-2"></i>Donate</a>
        </div>
    </footer>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Ensure jsPDF is loaded before use
        const { jsPDF } = window.jspdf;

        const tipsData = [
            // --- Concepts & Setup ---
            { id: 101, category: "concepts_setup", title: "Understanding Track Types", description: "MPC sequences are made of tracks: Audio, Drum, Keygroup, Plugin, MIDI, and CV. Each type serves a unique purpose for creating different elements of your song.", source: "Manual p.40", difficulty: "Easy", context: "The MPC is a multi-timbral device, meaning it can play multiple different sounds at once. Each sound source is assigned to a 'Track'. A DRUM track is for sample-based drum kits. A KEYGROUP track is for melodic sample-based instruments. A PLUGIN track hosts internal synth engines. An AUDIO track is for recording linear audio like vocals. MIDI and CV tracks are for controlling external hardware." },
            { id: 102, category: "concepts_setup", title: "Project vs. Program vs. Sample", description: "A Project contains everything: sequences, tracks, programs, and samples. A Program (like a Drum Kit or Keygroup) holds samples and their settings. A Sample is the raw audio file.", source: "Manual p.356", difficulty: "Easy", context: "Think of it like a hierarchy. The Project is the entire song file (.xpj). Inside that project are Programs (.xpm), which are the instruments. Inside those programs are the individual audio Samples (.wav). Understanding this structure is key to managing your files." },
            { id: 103, category: "concepts_setup", title: "Standalone vs. Controller Mode", description: "Standalone Mode runs the entire OS on the MPC hardware itself. Controller Mode connects the MPC to a computer to control the MPC 2 software or other DAWs like Ableton Live.", source: "Manual p.54", difficulty: "Easy", context: "Standalone mode is the MPC's main strength, allowing you to create music without a computer. Controller mode turns your MPC into a powerful hardware controller for the more feature-rich MPC Software on your Mac or PC, giving you access to VST/AU plugins and more processing power." },
            { id: 104, category: "concepts_setup", title: "Installing a SATA Drive", description: "Expand your internal storage by installing a 2.5” SATA drive (SSD or HDD). This allows you to store more projects, samples, and content directly on your MPC.", source: "Manual p.427", difficulty: "Intermediate", context: "The internal storage on many MPCs is limited. Installing your own SATA SSD (Solid State Drive) is the best way to expand storage for your sample library and projects. It ensures all your files load quickly and are always available in standalone mode." },
            { id: 105, category: "concepts_setup", title: "Activating Plugins", description: "Connect your MPC to the internet via Wi-Fi or Ethernet, then go to Preferences > Activate Plugins to log into your inMusic account and activate purchased instruments and effects.", source: "Manual p.57", difficulty: "Easy", context: "Many of the MPC's best instruments are 'premium' plugins that need to be activated online. This process links the plugin license to your specific MPC hardware. You only need to do this once per plugin." },
            { id: 106, category: "concepts_setup", title: "Understanding Polyphony", description: "Polyphony refers to the number of notes or voices that can sound simultaneously. Be mindful of long-decaying samples and layered sounds, as the MPC has a finite number of voices.", source: "MPC Bible p.187", difficulty: "Easy", context: "Each sample layer, effect, and plugin voice uses up polyphony. If you exceed the maximum, you may experience 'note stealing', where older notes are cut off to make room for new ones. Techniques like using Mute Groups and resampling CPU-heavy tracks can help manage polyphony." },
            { id: 107, category: "concepts_setup", title: "The Importance of Saving", description: "Regularly save your project to avoid losing work. Use 'Save As' to create different versions of your project, allowing you to revert to earlier ideas if needed.", source: "MPC Bible p.46", difficulty: "Easy", context: "An MPC project (.xpj) contains all sequences, programs, and sample assignments. The actual audio samples are stored in a corresponding [ProjectName]_ProjectData folder. When backing up or sharing, you must include both the .xpj file and its data folder." },
            { id: 108, category: "concepts_setup", title: "Screen Brightness & Dimming", description: "Adjust screen brightness and auto-dimming settings in Preferences > Hardware to conserve battery life on portable MPCs and reduce eye strain.", source: "Manual p.60", difficulty: "Easy", context: "For MPC Live/Live II users, managing power is crucial. Setting the screen to dim after a short period of inactivity can significantly extend your battery life during a session." },
            { id: 109, category: "concepts_setup", title: "Pad Sensitivity Settings", description: "Fine-tune how the pads respond to your touch in Preferences > Hardware. Adjust Pad Threshold and Pad Sensitivity to match your playing style.", source: "Manual p.60", difficulty: "Intermediate", context: "Pad Threshold sets the minimum force required to trigger a pad. Pad Sensitivity and Pad Curve adjust how velocity is registered. Experiment with these settings to find a response that feels natural and expressive for your finger drumming." },
            { id: 110, category: "concepts_setup", title: "Understanding MIDI Channels", description: "MIDI channels (1-16) allow you to route MIDI data to specific instruments or devices. This is essential for controlling multiple external synths or different sounds within a multi-timbral plugin.", source: "Manual p.49", difficulty: "Easy", context: "When you set a MIDI track to output on Channel 1, only devices set to receive on Channel 1 will respond. This allows you to have 16 different hardware synths or plugin instances all playing unique parts from different tracks in your MPC." },
            { id: 111, category: "concepts_setup", title: "Firmware Updates", description: "Regularly check for firmware updates on akaipro.com or via an internet connection in Preferences > Info. Updates provide new features, bug fixes, and stability improvements.", source: "Manual p.57", difficulty: "Easy", context: "Updating your firmware is crucial for getting the most out of your MPC. Updates can be installed via a USB drive or directly over Wi-Fi/Ethernet. Always back up your projects before performing an update." },
            { id: 112, category: "concepts_setup", title: "File System Compatibility", description: "Your MPC can read and write to exFAT, FAT32, and NTFS drives. For best compatibility between Mac and PC, exFAT is recommended for your SD cards and USB/SATA drives.", source: "Manual p.132", difficulty: "Easy", context: "Formatting your storage drives correctly ensures that files can be easily transferred between your MPC and your computer. While the MPC can read HFS+ (Mac) drives, it cannot write to them. exFAT is the most flexible cross-platform option." },
            { id: 113, category: "concepts_setup", title: "Audio Interface Expansion", description: "Connect a class-compliant USB audio interface to expand your MPC's audio inputs and outputs. This allows for multi-track recording and more flexible routing.", source: "Manual p.58", difficulty: "Intermediate", context: "In Preferences > Audio Device, you can select a connected USB interface. This is a game-changer for recording a full band or integrating multiple hardware synths, as it turns your MPC into the brain of a larger studio setup." },
            { id: 114, category: "concepts_setup", title: "Default Project Templates", description: "Set up a project with your favorite settings, drum kits, and plugins, then save it as a template (MENU > SAVE > Save As Template). This can be your default starting point for all new projects.", source: "MPC Bible p.55", difficulty: "Easy", context: "A well-designed template dramatically speeds up your workflow. You can have tracks pre-named (Kick, Snare, Bass), your favorite reverb set up on a return channel, and your go-to drum kit loaded and ready to go, letting you capture ideas faster." },
            { id: 115, category: "concepts_setup", title: "What are Q-Links?", description: "Q-Links are the rotary knobs on your MPC that can be mapped to control almost any parameter, from mixer levels to filter cutoffs and effect settings.", source: "Manual p.23", difficulty: "Easy", context: "Q-Links provide immediate, hands-on control over your sound. Their function changes depending on the current screen and selected Q-Link bank, making them incredibly versatile. You can also create custom Q-Link assignments in Q-LINK EDIT mode for performance macros." },
            
            // --- Main Mode & Workflow ---
            { id: 201, category: "main_mode_workflow", title: "Use Templates for Faster Startup", description: "Create a project template with your favorite drum kits, plugins, and mixer settings. Save it via Menu > Save > Save as Template. Load it automatically from Preferences > Project Load/Save.", source: "MPC Bible p.55", difficulty: "Easy", context: "A template saves your entire project state—loaded programs, track names, mixer settings, effects, etc. By creating a template with your go-to setup, you can skip the tedious process of loading the same sounds and configuring settings every time you start a new beat." },
            { id: 202, category: "main_mode_workflow", title: "Explode Drum Tracks for Mixing", description: "After programming a drum pattern on a single track, use Track > Explode. This separates each drum pad (kick, snare, etc.) onto its own track for individual mixing and effects.", source: "MPC Bible p.124", difficulty: "Intermediate", topTip: true, context: "This is a crucial step for professional-sounding mixes. While programming on one track is fast, mixing requires individual control. 'Explode' gives you a dedicated mixer channel for your kick, snare, hats, etc., so you can apply unique EQ, compression, and effects to each element." },
            { id: 203, category: "main_mode_workflow", title: "Using the Looper for Quick Ideas", description: "The Looper is perfect for capturing spontaneous ideas without stopping playback. Record a vocal line or instrument part, then export it as a sample to use in your project immediately.", source: "Manual p.323", difficulty: "Intermediate", context: "The Looper is always available for recording. If you're jamming over your beat and play a great melody or vocal freestyle, you can instantly capture it without having to set up a new track and hit record. It's a powerful tool for capturing creative moments." },
            { id: 204, category: "main_mode_workflow", title: "Next Sequence Mode for Live Arranging", description: "Use Next Sequence mode to trigger different sequences on the fly by pressing pads. This is a powerful tool for live performance, allowing you to arrange your song in real-time.", source: "Manual p.301", difficulty: "Intermediate", context: "Instead of having one long sequence, you can create different sequences for your intro, verse, and chorus. In Next Sequence mode, you can trigger these sections in any order, essentially performing your song's arrangement live. You can set sequences to switch at the end of the current bar or immediately." },
            { id: 205, category: "main_mode_workflow", title: "Using the Undo History", description: "Made a series of mistakes? Tap the clock icon in the toolbar to open Undo History. You can see a list of recent actions and revert back to a specific point.", source: "Manual p.53", difficulty: "Easy", context: "The MPC keeps a log of your recent actions. Instead of repeatedly pressing UNDO, you can open the Undo History and jump back to a specific point in your workflow, undoing multiple steps at once. This is a huge time-saver." },
            { id: 206, category: "main_mode_workflow", title: "Convert Song to Sequence", description: "After arranging your track in Song Mode, use the 'Convert > Seq' function to bounce the entire arrangement into a single, linear sequence for further editing or exporting.", source: "MPC Bible p.697", difficulty: "Intermediate", context: "Song Mode is great for arranging, but it has limitations (e.g., you can't record a continuous vocal track over it). Converting your song to a single long sequence makes it a linear track, just like in a traditional DAW. This is the final step before recording vocals or exporting the full track." },
            { id: 207, category: "main_mode_workflow", title: "Using the Metronome", description: "Enable the metronome by tapping the Metro icon in the toolbar. Tap and hold the icon to open its settings, where you can change the sound, volume, and count-in behavior.", source: "Manual p.72", difficulty: "Easy", context: "A metronome provides a steady click to help you record in time with your project's BPM. In the settings, you can configure a 'count-in' so the click plays for a bar before recording starts, giving you time to prepare." },
            { id: 208, category: "main_mode_workflow", title: "Accessing Shortcuts", description: "Swipe from the left edge of the screen to reveal five shortcut icons to your most-used modes. You can customize these by rearranging the icons in the Menu.", source: "Manual p.107", difficulty: "Easy", context: "The five icons in the first column of the MENU screen are always available as a quick-access sidebar. Drag your most frequently used modes (like BROWSER, SAMPLER, or PAD MIXER) to this first column to optimize your workflow and reduce menu diving." },
            { id: 209, category: "main_mode_workflow", title: "Retrospective Record", description: "Played a great melody but forgot to hit record? Press Shift + Rec to capture the last MIDI performance you played into the currently selected track.", source: "MPC Bible p.97", difficulty: "Intermediate", context: "The MPC is always listening to your MIDI input. This powerful feature allows you to recover a performance even if you weren't in record mode. It's a lifesaver for capturing those moments of spontaneous creativity." },
            { id: 210, category: "main_mode_workflow", title: "The 'Erase' Button", description: "While a sequence is playing, hold the ERASE button and press a pad to delete all notes for that pad in real-time. A quick way to clean up a performance.", source: "Manual p.82", difficulty: "Easy", context: "This is a classic MPC workflow. If you recorded a messy hi-hat pattern, you can just hold ERASE and the hi-hat pad during playback to wipe the pattern clean without stopping the music, then record a new take on the next loop." },
            { id: 211, category: "main_mode_workflow", title: "Tap Tempo", description: "Quickly set your project's BPM by tapping the TAP TEMPO button in time with the rhythm you want. You can configure the number of taps required in Preferences.", source: "Manual p.330", difficulty: "Easy", context: "If you're sampling a loop and don't know its tempo, you can find it by tapping along to the beat. This is much faster than trying to guess the BPM manually." },
            { id: 212, category: "main_mode_workflow", title: "Sequence Naming", description: "Keep your project organized by giving each sequence a descriptive name (e.g., 'Intro', 'Verse 1', 'Chorus'). Tap the 'A' icon next to the sequence name in MAIN mode.", source: "MPC Bible p.18", difficulty: "Easy", context: "As your projects grow, having clearly named sequences is essential for efficient arranging in Song Mode or Next Sequence Mode. It's a simple habit that saves a lot of confusion later." },
            { id: 213, category: "main_mode_workflow", title: "Track Naming", description: "Just like sequences, name your tracks descriptively (e.g., 'Kick', 'Bass Synth', 'Vocal Chop'). Tap the 'A' icon next to the track name in MAIN mode.", source: "MPC Bible p.24", difficulty: "Easy", context: "Proper track naming makes mixing much easier in the Channel Mixer and helps you quickly identify parts of your song. It's a fundamental organizational skill." },
            { id: 214, category: "main_mode_workflow", title: "Track Mute vs. Pad Mute", description: "Track Mute silences an entire track. Pad Mute silences individual pads within a program. Use TRACK MUTE for arranging sections and PAD MUTE for detailed performance variations.", source: "Manual p.244", difficulty: "Intermediate", context: "To drop out your drums for a breakdown, use Track Mute on the drum tracks. To create a variation where only the hi-hats are silent for a bar, use Pad Mute on the hi-hat pads. Both can be automated." },
            { id: 215, category: "main_mode_workflow", title: "Using Mute Groups", description: "In a program, assign two or more pads to the same Mute Group (e.g., open and closed hi-hats). When one pad in the group is triggered, it will silence any other pad in that group.", source: "MPC Bible p.164", difficulty: "Intermediate", context: "This is essential for realistic drum programming. An open hi-hat should stop ringing the moment a closed hi-hat is played. Mute Groups automate this, preventing unnatural sample overlap." },
            { id: 216, category: "main_mode_workflow", title: "Copying a Sequence", description: "Quickly create a variation of a sequence by copying it. In MAIN mode, tap the pencil icon next to the sequence name and select 'Copy Sequence'.", source: "MPC Bible p.117", difficulty: "Easy", context: "This is a core part of song arrangement. Copy your 'Verse' sequence to a new slot, then edit the copy to create a 'Verse 2' with slight variations, without having to rebuild the entire pattern from scratch." },
            { id: 217, category: "main_mode_workflow", title: "Checking System Resources", description: "Monitor your MPC's CPU and RAM usage by tapping the battery/chip icon in the top-right corner. This helps you manage project complexity and avoid crashes.", source: "Manual p.55", difficulty: "Easy", context: "If your MPC starts acting sluggish or you get 'not enough memory' errors, check the System Resources. You may need to use the 'Purge' function to remove unused samples or flatten tracks to free up CPU and RAM." },
            { id: 218, category: "main_mode_workflow", title: "The 'Purge' Function", description: "In the PROJECT screen (MENU > PROJECT), use the PURGE button to remove all unused samples from your project's RAM, freeing up memory.", source: "MPC Bible p.50", difficulty: "Intermediate", context: "As you work, you load many samples you might not end up using. These stay in RAM, consuming resources. Periodically purging unused samples is good housekeeping and essential for managing large projects." },
            { id: 219, category: "main_mode_workflow", title: "Using the Browser", description: "The Browser is your hub for loading samples, programs, projects, and expansions. Use the 'Places' and 'Content' tabs to navigate your drives and sound libraries.", source: "Manual p.132", difficulty: "Easy", context: "Mastering the Browser is key to a fast workflow. Set up folder shortcuts for your favorite sample packs. Use the file type filters to quickly find what you're looking for, and use the Audition feature to preview sounds before loading them." },
            { id: 220, category: "main_mode_workflow", title: "Full Level / Half Level", description: "Press FULL LEVEL to make all pad strikes register at maximum velocity (127). Use SHIFT + FULL LEVEL for half velocity (64). This is useful for consistent drum hits.", source: "Manual p.328", difficulty: "Easy", context: "While velocity variation adds human feel, sometimes you need a kick and snare to hit with the same power every time. FULL LEVEL ensures this consistency, perfect for hard-hitting electronic genres." },
            { id: 221, category: "main_mode_workflow", title: "16 Levels (Velocity)", description: "Activate 16 LEVELS and set the Type to Velocity. The 16 pads will now play the selected sound at 16 fixed, stepped velocity levels, from quietest to loudest.", source: "Manual p.75", difficulty: "Intermediate", context: "This is a classic MPC feature for programming dynamic, human-sounding patterns. You can precisely control the velocity of each note by choosing which pad to strike, which is more controlled than relying on finger sensitivity alone." },
            { id: 222, category: "main_mode_workflow", title: "16 Levels (Tune)", description: "Activate 16 LEVELS and set the Type to Tune. The 16 pads will now play the selected sound at 16 different pitches, creating a playable melodic scale.", source: "MPC Bible p.225", difficulty: "Intermediate", context: "This is the fastest way to turn any one-shot sample into a playable instrument. It's perfect for creating basslines from a single bass note or melodic hooks from a vocal sample." },
            { id: 223, category: "main_mode_workflow", title: "Using the Arpeggiator", description: "Enable the Arpeggiator (press ARP) to automatically create melodic patterns from held chords. You can change the pattern, rate, octave, and more.", source: "Manual p.79", difficulty: "Intermediate", context: "The arpeggiator is a powerful tool for generating complex melodic ideas quickly. It's not just for synth leads; try using it on a keygroup program with a chopped vocal or a plucked instrument for unique textures." },
            { id: 224, category: "main_mode_workflow", title: "List Edit Mode", description: "For precise, numerical editing of MIDI events, use LIST EDIT mode. Here you can see and edit the exact timing, velocity, and duration of every note.", source: "Manual p.179", difficulty: "Hard", context: "While GRID EDIT is great for visual editing, LIST EDIT offers unparalleled precision. It's the best place to fine-tune the timing of a drum hit by a few ticks or to ensure the velocity of multiple notes is exactly the same." },
            { id: 225, category: "main_mode_workflow", title: "Bouncing a Track to Audio", description: "Convert a MIDI track (with a plugin or program) into an audio track by going to TRACK EDIT > Bounce to Audio Track. This frees up CPU and 'prints' your effects.", source: "MPC Bible p.629", difficulty: "Intermediate", context: "If a plugin track is using a lot of CPU, bouncing it to audio is the solution. The new audio track uses far fewer resources. It's also a creative technique; you can now chop, reverse, and process the bounced audio in ways you couldn't with the original MIDI." },
            
            // --- Sampling & Sampler Mode ---
            { id: 301, category: "sampling_sampler", title: "Non-Destructive Slicing", description: "In Sample Edit > Chop, create your slices. Instead of converting to a new program immediately, you can play the slices directly from this mode, saving memory and time.", source: "MPC Bible p.487", difficulty: "Intermediate", context: "This method allows you to audition and perform with your chops without creating dozens of new audio files. The program simply references different start and end points within the original sample. It's a flexible, memory-efficient way to work with chopped loops." },
            { id: 302, category: "sampling_sampler", title: "Auto-Sampler for Hardware Synths", description: "Use the Auto-Sampler to automatically create a keygroup program from an external hardware synthesizer. It will play and record notes across a defined range and velocity.", source: "Manual p.289", difficulty: "Hard", topTip: true, context: "This powerful feature 'clones' your external hardware synths. The MPC sends MIDI notes to your synth, records the audio output for each note, and automatically maps the recordings into a playable keygroup instrument. It's the best way to bring your hardware synth sounds into the standalone environment." },
            { id: 303, category: "sampling_sampler", title: "Recording with a Threshold", description: "In the Sampler, set a recording threshold. Recording will only begin when the incoming audio signal exceeds this level, preventing silence at the start of your samples.", source: "MPC Bible p.196", difficulty: "Easy", context: "Setting a threshold automates the start of your recording. Instead of manually trying to time your recording perfectly, the MPC will wait and start recording the instant it detects a sound, ensuring your samples are tight and clean from the start." },
            { id: 304, category: "sampling_sampler", title: "Resampling Internal Audio", description: "In the Sampler, set the input source to 'Resample L+R' to record any audio playing within your MPC project. This is perfect for creating new loops or flattening tracks with effects.", source: "MPC Bible p.519", difficulty: "Intermediate", topTip: true, context: "Resampling is a core MPC technique. It allows you to 'bounce' a track or even your entire mix into a new audio sample. You can then chop, flip, and re-process your own creations to generate new ideas, or use it to 'flatten' CPU-heavy plugin tracks to save resources." },
            { id: 305, category: "sampling_sampler", title: "Input Monitoring for Zero Latency", description: "In the Sampler, tap the Monitor button to hear your input source directly, bypassing any potential latency from effects processing while you record.", source: "Manual p.282", difficulty: "Easy", context: "When recording external instruments or vocals, latency (a slight delay) can make it difficult to perform in time. Enabling input monitoring lets you hear the live signal without any delay, ensuring your recordings are perfectly timed." },
            { id: 306, category: "sampling_sampler", title: "Sampling from Vinyl", description: "Connect your turntable to the RCA inputs and set the switch to PHONO. Don't forget to connect the grounding wire to the grounding terminal to eliminate hum.", source: "Manual p.333", difficulty: "Easy", context: "The MPC's phono preamp is designed to boost the low-level signal from a turntable. Proper connection, including the ground wire, is essential for a clean, noise-free sample." },
            { id: 307, category: "sampling_sampler", title: "Sampling in Mono", description: "When sampling a mono source like a bass guitar or a vocal, set the Sampler input to a single channel (e.g., Input 1) and the output to Mono. This saves memory and avoids unnecessary stereo files.", source: "Manual p.282", difficulty: "Easy", context: "Many classic samples are in mono. Sampling in mono is an efficient practice that saves disk space and RAM. There's no benefit to recording a mono source as a stereo file." },
            { id: 308, category: "sampling_sampler", title: "Setting Max Sample Length", description: "In the Sampler, use the 'Max Length' field to pre-define the duration of your recording. This is useful for creating samples of a specific length, like a 4-bar loop.", source: "Manual p.283", difficulty: "Intermediate", context: "Instead of manually stopping the recording, you can have the MPC do it for you. If you know you're sampling a 2-bar loop at 120 BPM, you can set the max length to 4 seconds, and the sampler will stop automatically." },
            { id: 309, category: "sampling_sampler", title: "Keep or Discard", description: "After recording a sample, the 'Keep or Discard' window appears. Always name your sample immediately to keep your project organized.", source: "Manual p.285", difficulty: "Easy", context: "Developing a consistent naming convention (e.g., 'Kick_Vinyl_01', 'Bass_Moog_C2') is a crucial habit. It makes finding sounds in the Browser and Sample Pool much easier as your projects grow." },
            { id: 310, category: "sampling_sampler", title: "Assign to Pad After Sampling", description: "From the 'Keep or Discard' window, you can directly assign your new sample to a pad in a specific program, streamlining your workflow.", source: "Manual p.285", difficulty: "Easy", context: "This saves you from having to go to SAMPLE ASSIGN or PROGRAM EDIT later. You can record a kick, name it, and assign it to pad A01 all in one seamless process." },
            { id: 311, category: "sampling_sampler", title: "Sampling with Effects", description: "You can insert up to four effects in the Sampler to record your audio source with the effects already applied. This is a 'destructive' process.", source: "Manual p.282", difficulty: "Intermediate", context: "This is useful for committing to a sound. For example, you can sample a guitar through a simulated amp (AIR Amp Sim) to capture that specific tone. Be aware that the effect cannot be removed from the sample later." },
            { id: 312, category: "sampling_sampler", title: "Pad Tapping to Sample", description: "In the Sampler, use Pad Tap mode to record directly to pads. Pressing a pad starts recording to it; pressing another pad stops the first and starts recording to the new one.", source: "Manual p.287", difficulty: "Intermediate", context: "This is a fast, performance-oriented way to capture multiple sounds in quick succession. It's great for sampling a series of drum hits from a vinyl record or a hardware drum machine." },
            { id: 313, category: "sampling_sampler", title: "Pad Holding to Sample", description: "Similar to Pad Tap, Pad Hold mode records to a pad only for as long as you hold it down. Releasing the pad stops the recording for that pad.", source: "Manual p.288", difficulty: "Intermediate", context: "This mode gives you precise control over the length of your recorded samples, as the recording duration is tied directly to how long you press the pad." },
            { id: 314, category: "sampling_sampler", "title": "Slicing While Sampling", "description": "In the SAMPLER, use 'Slice' mode to insert slice markers in real-time as you record. Tap a pad each time you want to create a new slice.", "source": "Manual p.286", "difficulty": "Intermediate", "context": "This is an incredibly fast way to chop a sample. As a drum break plays, you can tap a pad on each drum hit (kick, snare, etc.). When you stop recording, the MPC has already chopped the break for you, ready to be converted to a program." },
            { id: 315, category: "sampling_sampler", "title": "Using the Tuner", "description": "The MPC has a built-in Tuner, accessible from the SAMPLER screen or the main pull-down menu. Use it to check the pitch of your external instruments before sampling.", "source": "Manual p.54", "difficulty": "Easy", "context": "Ensuring your instruments are in tune before you sample them is a fundamental step for a professional sound. The built-in tuner makes it easy to quickly check a guitar, bass, or hardware synth." },
            { id: 316, category: "sampling_sampler", "title": "Gain Staging", "description": "When sampling, adjust the REC VOL/GAIN knob so the input signal is as loud as possible without clipping (going into the red on the meter). This maximizes the signal-to-noise ratio.", "source": "MPC Bible p.193", "difficulty": "Easy", "context": "A strong, clean signal is the foundation of a good sample. If the signal is too low, you'll have to boost it later, which also boosts any background noise. Aim for the loudest clean signal you can get." },
            { id: 317, category: "sampling_sampler", "title": "Auto-Sampling a Plugin", "description": "The Auto-Sampler can also be used on internal MPC plugins. Set the input to 'Resample L+R' and select the plugin track to create a keygroup version of any plugin patch.", "source": "MPC Bible p.635", "difficulty": "Hard", "context": "This is a powerful way to convert a CPU-heavy plugin patch into a more efficient keygroup program. It's also useful for capturing a specific sound you've designed in a plugin and saving it as a portable, sample-based instrument." },
            { id: 318, category: "sampling_sampler", "title": "Understanding Sample Pools", "description": "Every sample you load or record is added to the Project's Sample Pool. A program then references these samples. Deleting a sample from a program doesn't remove it from the pool.", "source": "MPC Bible p.49", "difficulty": "Easy", "context": "The Sample Pool is the central library for all audio in your project. To completely remove a sample and free up RAM, you must delete it from the Sample Pool itself, which can be done in the PROJECT screen." },
            { id: 319, category: "sampling_sampler", "title": "Exporting from the Looper", "description": "After creating a loop in the LOOPER, tap EXPORT to save it as a sample in your project's sample pool. You can then assign it to a pad or use it in an audio track.", "source": "Manual p.326", "difficulty": "Intermediate", "context": "The Looper is great for capturing ideas, but to integrate those ideas into your sequence, you need to export them. This turns your live loop into a standard .wav sample that can be chopped, processed, and sequenced like any other." },
            { id: 320, category: "sampling_sampler", "title": "Recording Vocals", "description": "For best results when recording vocals, use a condenser microphone connected to an input with phantom power (+48V) enabled. Use a pop filter to prevent plosives.", "source": "MPC Bible p.756", "difficulty": "Intermediate", "context": "While any mic can work, a condenser mic will capture the most detail. The MPC X and Key models have built-in phantom power. For other MPCs, you'll need an external audio interface or mixer with a mic preamp and +48V power." },
            
            // --- Sample Edit & Chop ---
            { id: 401, category: "sample_edit_chop", title: "Time Stretching with Warp", description: "In Sample Edit, use the Warp function to change a sample's length without altering its pitch. This is essential for matching loops to your project's tempo.", source: "MPC Bible p.468", difficulty: "Intermediate", context: "Warping allows you to make a loop fit any BPM. The MPC offers several warp algorithms; 'Pro Ten' is generally the best for quality in standalone, while 'Elastique Pro' is superior in the MPC Software. Use it to sync loops or for creative sound design by extreme stretching." },
            { id: 402, category: "sample_edit_chop", title: "Create Stems with AI", description: "In Sample Edit, use the 'Create Stems' function to separate a sample into vocals, bass, drums, and other musical elements using AI. A powerful tool for remixing and sampling.", source: "Manual p.186", difficulty: "Hard", context: "This groundbreaking feature lets you isolate parts of a finished song. Want just the vocals from a track? Or the drum break without the bassline? 'Create Stems' analyzes the audio and generates separate .wav files for each element, opening up a new world of sampling possibilities." },
            { id: 403, category: "sample_edit_chop", title: "Discard, Extract, and Process Slices", description: "In Sample Edit, use the Process menu to apply effects like Normalize, Reverse, or Pitch Shift to your sample. You can also Discard unwanted parts or Extract a selection as a new sample.", source: "MPC Bible p.211", difficulty: "Intermediate", context: "These are fundamental, destructive editing tools. 'Discard' permanently removes audio outside your start/end points. 'Extract' creates a new sample from the audio within your start/end points. 'Process' allows you to apply permanent changes like gain adjustments or creative effects." },
            { id: 404, category: "sample_edit_chop", title: "Using Chop Mode", description: "In Sample Edit, use Chop Mode to slice a sample into regions based on transients, BPM, or a set number of regions. This is the foundation of classic MPC workflows.", source: "MPC Bible p.396", difficulty: "Easy", suggestedTipId: 301, context: "Chopping is the art of slicing a sample (often a drum break or melodic loop) into smaller pieces to be replayed and rearranged on the pads. The MPC offers several methods: 'Regions' for equal divisions, 'BPM' for tempo-based slicing, and 'Threshold' for automatically detecting transients like drum hits." },
            { id: 405, category: "sample_edit_chop", title: "Zero Snap for Clean Loops", description: "In Sample Edit settings, enable 'Zero Snap' to force start and end points to a zero-crossing in the waveform. This prevents clicks and pops in your loops.", source: "MPC Bible p.209", difficulty: "Intermediate", context: "A zero-crossing is where the audio waveform has zero amplitude. Starting or ending an audio file at a point with amplitude can cause an audible click. 'Zero Snap' intelligently moves your edit points to the nearest zero-crossing, ensuring clean, pop-free loops and chops." },
            { id: 406, category: "sample_edit_chop", title: "Converting Slices to a New Program", description: "After chopping a sample, press Shift + Convert to instantly create a new Drum Program with each slice assigned to a different pad.", source: "MPC Bible p.405", difficulty: "Intermediate", context: "This is the final step in the chopping workflow. The 'Convert' menu offers options like creating a new program with new, cropped samples (destructive) or a program that references the original sample (non-destructive), as well as creating a 'Patched Phrase' for tempo-synced loops." },
            { id: 407, category: "sample_edit_chop", title: "Patched Phrase Creation", description: "After chopping a loop to individual hits, use Shift > Convert > Patched Phrase. This creates a tempo-flexible loop that automatically adapts to your project's BPM.", source: "MPC Bible p.474", difficulty: "Hard", context: "A Patched Phrase is an intelligent sample that contains your slice information. When you change your sequence tempo, the MPC automatically adjusts the timing between the slices, allowing the loop to play perfectly in time at any BPM without traditional time-stretching." },
            
            // --- Sequencing & Grid ---
            { id: 501, category: "sequencing_grid", title: "Humanize Your Quantized Patterns", description: "After recording a quantized sequence, go to Sequence Edit > Humanize. Apply subtle randomization to timing and velocity to make your MIDI patterns feel more natural and less robotic.", source: "MPC Bible p.450", difficulty: "Intermediate", topTip: true, context: "Quantizing can make beats sound stiff. The Humanize function adds subtle, random variations to note timing, duration, and velocity, mimicking the imperfections of a live performance and adding groove and feel back into a rigid pattern." },
            { id: 502, category: "sequencing_grid", title: "Using Timing Correct (TC)", description: "Access the Timing Correct (TC) window to quantize your MIDI performances. You can adjust the time division, swing, strength, and other parameters to get the perfect feel.", source: "MPC Bible p.98", difficulty: "Easy", suggestedTipId: 501, context: "Timing Correct (or Quantize) aligns your recorded MIDI notes to a specific rhythmic grid (e.g., 1/16 notes). This is essential for creating tight, in-time drum patterns and melodic lines. You can apply it during recording or after the fact." },
            { id: 503, category: "sequencing_grid", title: "Editing Velocity in Grid View", description: "In Grid View, expand the velocity lane at the bottom to see and edit the velocity of each note. You can draw in new velocities with the pencil tool for dynamic patterns.", source: "MPC Bible p.91", difficulty: "Easy", context: "Velocity is a key component of an expressive performance. The Grid View's velocity lane allows you to visually edit the velocity of every note, letting you create crescendos, accents, and ghost notes to add dynamics and realism to your sequences." },
            { id: 504, category: "sequencing_grid", title: "Double the Length of a Sequence", description: "In Main Mode, tap the pencil icon next to the sequence name and select 'Double Length'. This will double the sequence length and duplicate all events, perfect for building out a pattern.", source: "MPC Bible p.116", difficulty: "Easy", context: "This is a quick way to turn a 2-bar loop into a 4-bar phrase, or a 4-bar phrase into an 8-bar section. It duplicates all MIDI and automation, giving you a longer canvas to add variations and turn simple loops into evolving musical parts." },
            { id: 505, category: "sequencing_grid", title: "Using the Step Sequencer", description: "Enter Step Sequencer mode to program patterns by tapping the pads, which represent steps in the sequence. This is a classic and intuitive way to build drum beats.", source: "Manual p.174", difficulty: "Easy", context: "The Step Sequencer provides a visual, grid-based method for programming patterns, similar to classic drum machines like the TR-808. Each pad represents a step (typically a 16th note), allowing you to easily tap in complex rhythms and see your entire pattern at a glance." },
            { id: 506, category: "sequencing_grid", title: "Splitting Events (Ratchets)", description: "In the Track row, use the pencil icon > Split Events to divide a single MIDI note into multiple smaller notes (ratchets), creating fast rolls and fills.", source: "MPC Bible p.128", difficulty: "Intermediate", context: "This feature is perfect for creating modern trap-style hi-hat rolls or fast snare fills. It takes a single note and divides it into a specified number of smaller, equal-length notes, automating a process that would be difficult to play by hand." },
            
            // --- Programs & Keygroups ---
            { id: 601, category: "programs_keygroups", title: "Layer Samples with Velocity Switching", description: "In a Drum Program, assign multiple samples to the same pad on different layers. Use the Velocity Start/End ranges to trigger different samples depending on how hard you hit the pad.", source: "MPC Bible p.429", difficulty: "Hard", context: "This is a powerful technique for creating expressive, dynamic instruments. For example, you can assign a soft, medium, and hard snare sample to a single pad, and the MPC will play the appropriate sample based on how hard you play, mimicking the response of a real drum." },
            { id: 602, category: "programs_keygroups", title: "Flatten Pads to Save CPU", description: "If a drum pad has many layers and effects, it can use a lot of CPU. In Track Edit, use the 'Flatten Pad' function to resample the pad's entire sound into a single new sample, freeing up resources.", source: "MPC Bible p.517", difficulty: "Intermediate", context: "Complex layered sounds with multiple effects can be resource-intensive. 'Flatten Pad' renders the entire sound of a pad—including all layers and effects—into a new, single audio file. This drastically reduces CPU load, which is crucial for managing large projects in standalone mode." },
            { id: 603, category: "programs_keygroups", title: "Use the Mod Matrix for Complex Sounds", description: "In a Keygroup or Plugin program, use the Mod Matrix to route modulation sources (like LFOs or envelopes) to destinations (like pitch or filter cutoff) for evolving, complex sound design.", source: "Manual p.238", difficulty: "Hard", context: "The Modulation Matrix is the heart of advanced sound design. It allows you to create complex relationships between different parameters. For example, you can make an LFO control the filter cutoff while velocity controls the LFO's speed, creating dynamic, evolving textures." },
            { id: 604, category: "programs_keygroups", title: "Shaping Sounds with Envelopes", description: "In Track Edit, use the Amp and Filter envelopes to shape your sounds. Adjust the Attack, Decay, Sustain, and Release (ADSR) to control how a sound's volume and timbre evolve over time.", source: "MPC Bible p.152", difficulty: "Intermediate", context: "Envelopes are fundamental to sound design. The Amp Envelope controls a sound's volume over time (e.g., making a sound fade in slowly or end abruptly). The Filter Envelope controls the filter's cutoff over time, allowing you to create filter sweeps and other dynamic timbral changes." },
            { id: 605, category: "programs_keygroups", title: "Creating a Keygroup from a Sample", description: "In Track Edit, select a sample on a pad and tap the keyboard+ icon. This instantly creates a new Keygroup track, pitching the sample across the pads for melodic playing.", source: "MPC Bible p.582", difficulty: "Intermediate", context: "This is the quickest way to turn any one-shot sample into a playable instrument. It takes a single sample, creates a new Keygroup program, and automatically maps the sample across the pads or a keyboard, allowing you to instantly play melodies and chords with it." },
            { id: 606, category: "programs_keygroups", title: "Random Layer Playback (Round Robin)", description: "Assign multiple, similar samples to different layers of a single pad. In Program Edit > Global, set Layer Play to 'Random' or 'Cycle' to trigger a different sample each time, creating natural variation.", source: "MPC Bible p.158", difficulty: "Hard", context: "This technique, often called 'round robin,' is essential for realism. By assigning slightly different recordings of the same sound (e.g., three different hi-hat hits) to a pad and setting Layer Play to 'Cycle' or 'Random,' you can avoid the robotic 'machine gun' effect and create more natural-sounding patterns." }
        ];
        
        const glossaryData = [
            { term: "ADSR", definition: "Stands for Attack, Decay, Sustain, Release. These are the four stages of a standard sound envelope that shape its volume or other parameters over time." },
            { term: "Aftertouch", definition: "MIDI data sent when pressure is applied to a key or pad after it has been initially struck. It's often used for expressive control like adding vibrato or filter sweeps." },
            { term: "Arpeggiator", definition: "A device or function that automatically creates arpeggios (broken chords) from held notes. The MPC's arpeggiator can create complex melodic and rhythmic patterns." },
            { term: "Automation", definition: "The process of recording the movement of knobs, faders, and other parameters over time, allowing for dynamic changes in a mix or sound." },
            { term: "BPM", definition: "Beats Per Minute. The unit of measurement for the tempo of a piece of music." },
            { term: "Clipping", definition: "A form of distortion that occurs when an audio signal's amplitude exceeds the maximum level that a system can handle." },
            { term: "Compressor", definition: "An audio effect that reduces the dynamic range of a signal, making quiet parts louder and loud parts quieter for a more controlled and punchy sound." },
            { term: "CV/Gate", definition: "Control Voltage and Gate. An analog method for synthesizers to communicate. CV typically controls pitch, while Gate signals control when a note starts and stops." },
            { term: "DAW", definition: "Digital Audio Workstation. A software application used for recording, editing, and producing audio files (e.g., Ableton Live, FL Studio, Logic Pro)." },
            { term: "Envelope", definition: "A shape that changes a sound's characteristics over time. Most commonly used for volume (Amp Envelope) and filter cutoff (Filter Envelope)." },
            { term: "Filter", definition: "An effect that removes or boosts certain frequencies from a sound. Common types are Low-Pass (removes highs), High-Pass (removes lows), and Band-Pass (removes highs and lows)." },
            { term: "Keygroup Program", definition: "An MPC program type where a sample is pitched across the pads or a keyboard, allowing you to play it melodically." },
            { term: "LFO", definition: "Low-Frequency Oscillator. An oscillator that moves very slowly, used to modulate parameters like pitch (for vibrato), volume (for tremolo), or filter cutoff to create movement in a sound." },
            { term: "MIDI", definition: "Musical Instrument Digital Interface. A protocol that allows electronic instruments, computers, and other devices to communicate with each other." },
            { term: "Quantize", definition: "The process of aligning MIDI notes to a specific rhythmic grid to correct timing imperfections. Also known as Time Correction (TC) on the MPC." },
            { term: "Sample Rate", definition: "The number of times per second that a sample of an analog audio signal is taken to convert it into a digital signal. A standard CD uses a sample rate of 44.1 kHz (44,100 times per second)." },
            { term: "Submix", definition: "A track that groups the audio output of several other tracks together. This allows you to process a group of sounds (like all your drums) with the same effects." },
            { term: "Velocity", definition: "A MIDI value that represents how hard a key or pad was struck (from 0 to 127). It typically controls the volume of a note, but can be mapped to other parameters." },
            { term: "Warp", definition: "An algorithm that allows you to change the tempo (speed) of an audio sample without changing its pitch. Also known as time-stretching." },
            { term: "Transient", definition: "The initial, high-energy peak at the beginning of a sound's waveform, like the crack of a snare drum." },
            { term: "Zero Crossing", definition: "The point where an audio waveform crosses the center horizontal line (zero amplitude). Editing samples at zero crossings helps prevent audible clicks and pops." },
            { term: "Sidechain Compression", definition: "An effect where the volume of one track is automatically lowered by the presence of another track. Commonly used to make a kick drum 'punch through' a bassline." },
            { term: "Pad Perform", definition: "An MPC mode that maps musical scales, chords, or progressions across the 16 pads, making it easier to play complex musical parts." },
            { term: "Round Robin", definition: "A technique where multiple different samples of the same sound are triggered in rotation (or randomly) to create natural variation and avoid the 'machine gun' effect." }
        ];

        const drumPatterns = [
            { name: "Classic Boom Bap", artist: "DJ Premier Style", pattern: { 'Kick': [0, 6], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Funky Drummer", artist: "James Brown", pattern: { 'Kick': [0, 2, 7, 10], 'Snare': [4, 6, 12, 14], 'Hi-Hat': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "Basic Trap", artist: "Metro Boomin Style", pattern: { 'Kick': [0, 10], 'Snare': [4, 12], 'Hi-Hat': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "Amen Break", artist: "The Winstons", pattern: { 'Kick': [0, 7, 10], 'Snare': [4, 12], 'Ride': [0, 2, 4, 6, 7, 8, 10, 12, 14, 15] } },
            { name: "When the Levee Breaks", artist: "Led Zeppelin", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Billie Jean", artist: "Michael Jackson", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Grindin'", artist: "The Neptunes", pattern: { 'Kick': [0, 4, 8, 12], 'Snare': [2, 6, 10, 14], 'Perc': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "Impeach the President", artist: "The Honey Drippers", pattern: { 'Kick': [0, 7, 10], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Fool's Gold", artist: "The Stone Roses", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "It's a New Day", artist: "Skull Snaps", pattern: { 'Kick': [0, 6, 10], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Ashley's Roachclip", artist: "The Soul Searchers", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Synthetic Substitution", artist: "Melvin Bliss", pattern: { 'Kick': [0, 2, 8, 10], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Think (About It)", artist: "Lyn Collins", pattern: { 'Kick': [0, 6], 'Snare': [4, 12], 'Tambourine': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "N.T.", artist: "Kool & The Gang", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "The Big Beat", artist: "Billy Squier", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Clap': [4, 12] } },
            { name: "Walk This Way", artist: "Aerosmith / Run-DMC", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Planet Rock", artist: "Afrika Bambaataa", pattern: { 'Kick': [0, 6, 10], 'Snare': [4, 12], 'Clap': [4, 12] } },
            { name: "Shook Ones, Pt. II", artist: "Mobb Deep", pattern: { 'Kick': [0, 2, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "C.R.E.A.M.", artist: "Wu-Tang Clan", pattern: { 'Kick': [0, 6], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Still D.R.E.", artist: "Dr. Dre", pattern: { 'Kick': [0, 7], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Regulate", artist: "Warren G", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Passin' Me By", artist: "The Pharcyde", pattern: { 'Kick': [0, 6, 10], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Runnin'", artist: "The Pharcyde (J Dilla Remix)", pattern: { 'Kick': [0, 3, 8, 11], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "The Message", artist: "Grandmaster Flash", pattern: { 'Kick': [0, 4, 8, 12], 'Snare': [6, 14], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Rock Box", artist: "Run-DMC", pattern: { 'Kick': [0, 4, 8, 12], 'Snare': [4, 12], 'Cowbell': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Paul Revere", artist: "Beastie Boys", pattern: { 'Kick': [0, 2, 4, 6, 8, 10, 12, 14], 'Snare': [], 'Hi-Hat': [] } },
            { name: "Peter Piper", artist: "Run-DMC", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Cowbell': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] } },
            { name: "It Takes Two", artist: "Rob Base & DJ E-Z Rock", pattern: { 'Kick': [0, 8], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "Push It", artist: "Salt-N-Pepa", pattern: { 'Kick': [0, 4, 8, 12], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } },
            { name: "In Da Club", artist: "50 Cent", pattern: { 'Kick': [0, 6], 'Snare': [4, 12], 'Hi-Hat': [0, 2, 4, 6, 8, 10, 12, 14] } }
        ];

        // DOM ELEMENT VARIABLES (Declared ONCE)
        const tipsContainer = document.getElementById('tips-container');
        const topTipsContainer = document.getElementById('top-tips-container');
        const categoryFilterContainer = document.getElementById('category-filter-container');
        const difficultySortButtons = document.querySelectorAll('.difficulty-sort-button');
        const tipModal = document.getElementById('tip-modal');
        const closeModalButton = document.getElementById('close-modal');
        const glossaryModal = document.getElementById('glossary-modal');
        const closeGlossaryModalButton = document.getElementById('close-glossary-modal');
        const glossaryButton = document.getElementById('glossary-button');
        const glossaryContent = document.getElementById('glossary-content');
        const glossarySearchInput = document.getElementById('glossary-search-input');
        const mainTipView = document.getElementById('main-tip-view');
        const modalTitle = document.getElementById('modal-title');
        const modalCategory = document.getElementById('modal-category');
        const modalDescription = document.getElementById('modal-description');
        const modalSource = document.getElementById('modal-source');
        const copyTipButton = document.getElementById('copy-tip-button');
        const moreInfoButton = document.getElementById('more-info-button');
        const detailsView = document.getElementById('details-view');
        const detailsTitle = document.getElementById('details-title');
        const detailsCategory = document.getElementById('details-category');
        const detailsContent = document.getElementById('details-content');
        const backToTipButton = document.getElementById('back-to-tip-button');
        const detailsRelatedList = document.getElementById('details-related-list');
        const detailsGlossaryList = document.getElementById('details-glossary-list');
        const suggestedTipContainer = document.getElementById('suggested-tip-container');
        const suggestedTipBox = document.getElementById('suggested-tip-box');
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const downloadPdfButton = document.getElementById('download-pdf-button');
        const mpcSauceButton = document.getElementById('mpc-sauce-button');
        const mpcSauceModal = document.getElementById('mpc-sauce-modal');
        const closeMpcSauceModalButton = document.getElementById('close-mpc-sauce-modal');
        
        // STATE VARIABLES
        let currentCategory = 'all';
        let currentDifficulty = 'all';
        let currentTip = null;

        // ICONS
        const categoryIcons = {
            concepts_setup: 'fa-solid fa-lightbulb',
            main_mode_workflow: 'fa-solid fa-bolt',
            sampling_sampler: 'fa-solid fa-microphone-lines',
            sample_edit_chop: 'fa-solid fa-scissors',
            sequencing_grid: 'fa-solid fa-border-all',
            programs_keygroups: 'fa-solid fa-layer-group',
            audio_tracks: 'fa-solid fa-waveform-lines',
            mixing_effects: 'fa-solid fa-sliders',
            automation_qlinks: 'fa-solid fa-robot',
            sound_design_synthesis: 'fa-solid fa-atom',
            performance_features: 'fa-solid fa-person-running',
            integration_sync: 'fa-solid fa-link',
            file_management_export: 'fa-solid fa-folder-open',
            advanced_workflows: 'fa-solid fa-graduation-cap',
            controller_mode_software: 'fa-solid fa-computer'
        };

        function getIconHtml(category) {
            const iconClass = categoryIcons[category] || 'fa-solid fa-info-circle';
            return `<i class="${iconClass} tip-icon"></i>`;
        }
        
        function getDifficultyBadge(difficulty) {
            if (!difficulty) return '';
            const lowerCaseDifficulty = difficulty.toLowerCase();
            let badgeClass = '';
            switch(lowerCaseDifficulty) {
                case 'easy': badgeClass = 'difficulty-easy'; break;
                case 'intermediate': badgeClass = 'difficulty-intermediate'; break;
                case 'hard': badgeClass = 'difficulty-hard'; break;
            }
            return `<span class="difficulty-badge ${badgeClass}">${difficulty}</span>`;
        }

        function populateCategories() {
            const categories = [...new Set(tipsData.map(tip => tip.category))];
            categoryFilterContainer.innerHTML = '<button class="tip-category-button active" data-category="all">All Tips</button>';
            
            categories.sort();

            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'tip-category-button';
                button.dataset.category = category;
                // A more robust way to format category names
                const formattedName = category
                    .replace(/_/g, ' & ')
                    .replace(/\b\w/g, l => l.toUpperCase());
                button.textContent = formattedName;
                categoryFilterContainer.appendChild(button);
            });

            document.querySelectorAll('.tip-category-button').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.tip-category-button').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentCategory = button.dataset.category;
                    displayTips(currentCategory, searchInput.value, currentDifficulty);
                });
            });
        }
        
        function displayTips(category, searchTerm = '', difficulty = 'all') {
            tipsContainer.innerHTML = '';
            let filteredTips = tipsData;

            if (category !== 'all') {
                filteredTips = filteredTips.filter(tip => tip.category === category);
            }

            if (difficulty !== 'all') {
                filteredTips = filteredTips.filter(tip => tip.difficulty === difficulty);
            }

            if (searchTerm.trim()) {
                const lowerCaseSearchTerm = searchTerm.toLowerCase().trim();
                filteredTips = filteredTips.filter(tip =>
                    tip.title.toLowerCase().includes(lowerCaseSearchTerm) ||
                    tip.description.toLowerCase().includes(lowerCaseSearchTerm) ||
                    (tip.context && tip.context.toLowerCase().includes(lowerCaseSearchTerm)) ||
                    tip.category.replace(/_/g, ' ').toLowerCase().includes(lowerCaseSearchTerm)
                );
            }

            if (filteredTips.length === 0) {
                tipsContainer.innerHTML = '<p class="text-center col-span-full text-lg">No tips found. Try adjusting your filters or search term.</p>';
                return;
            }

            filteredTips.forEach(tip => {
                const tipElement = document.createElement('div');
                tipElement.className = 'card tip-item cursor-pointer';
                tipElement.innerHTML = `
                    <div class="flex-grow">
                        <h4 class="text-xl font-semibold mb-2">${getIconHtml(tip.category)}${tip.title}</h4>
                        <p class="text-sm mb-2">${tip.description}</p>
                    </div>
                    <div class="mt-auto pt-2 flex justify-end items-center">
                         ${getDifficultyBadge(tip.difficulty)}
                    </div>
                `;
                tipElement.addEventListener('click', () => openModal(tip));
                tipsContainer.appendChild(tipElement);
            });
        }
        
        function displayTopTips() {
            topTipsContainer.innerHTML = '';
            const topTips = tipsData.filter(tip => tip.topTip).slice(0, 6);
            if(topTips.length < 6) {
                // Fallback if not enough tips are marked as topTip
                const fallbackTips = tipsData.filter(t => !t.topTip).slice(0, 6 - topTips.length);
                topTips.push(...fallbackTips);
            }
            topTips.forEach(tip => {
                 const tipElement = document.createElement('div');
                tipElement.className = 'featured-tip p-4 rounded-lg cursor-pointer';
                tipElement.innerHTML = `
                    <h4 class="text-lg font-semibold mb-2">${getIconHtml(tip.category)}${tip.title}</h4>
                    <p class="text-sm text-gray-400">${tip.description}</p>
                `;
                tipElement.addEventListener('click', () => openModal(tip));
                topTipsContainer.appendChild(tipElement);
            });
        }
        
        function displayRelatedTipsInModal(currentTip) {
            detailsRelatedList.innerHTML = '';
            const related = tipsData.filter(tip => tip.category === currentTip.category && tip.id !== currentTip.id);
            const shuffled = related.sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 5);
            
            if (selected.length === 0) {
                 detailsRelatedList.innerHTML = '<li>No related tips found.</li>';
                 return;
            }
            
            selected.forEach(tip => {
                const li = document.createElement('li');
                li.className = 'mb-2';
                const a = document.createElement('a');
                a.href = '#';
                a.textContent = tip.title;
                a.className = 'hover:text-[var(--akai-accent)] transition-colors';
                a.onclick = (e) => {
                    e.preventDefault();
                    openModal(tip);
                };
                li.appendChild(a);
                detailsRelatedList.appendChild(li);
            });
        }

        function displayGlossaryTermsInModal(tip) {
            detailsGlossaryList.innerHTML = '';
            const tipText = (tip.context + ' ' + tip.description).toLowerCase();
            const foundTerms = new Set();

            glossaryData.forEach(term => {
                const regex = new RegExp(`\\b${term.term.toLowerCase()}\\b`, 'g');
                if (tipText.match(regex)) {
                    foundTerms.add(term.term);
                }
            });

            if (foundTerms.size === 0) {
                detailsGlossaryList.innerHTML = '<p>No relevant glossary terms found for this tip.</p>';
                return;
            }

            foundTerms.forEach(termName => {
                const termData = glossaryData.find(g => g.term === termName);
                if (termData) {
                    const termElement = document.createElement('div');
                    termElement.className = 'mb-4';
                    termElement.innerHTML = `
                        <p><strong>${termData.term}:</strong> ${termData.definition}</p>
                    `;
                    detailsGlossaryList.appendChild(termElement);
                }
            });
        }


        function displaySuggestedTip(tip) {
            if (tip.suggestedTipId) {
                const suggestedTip = tipsData.find(t => t.id === tip.suggestedTipId);
                if (suggestedTip) {
                    suggestedTipBox.innerHTML = `
                        <h5 class="font-bold text-white">${getIconHtml(suggestedTip.category)}${suggestedTip.title}</h5>
                        <p class="text-sm text-gray-400">${suggestedTip.description}</p>
                    `;
                    suggestedTipBox.onclick = () => openModal(suggestedTip);
                    suggestedTipContainer.classList.remove('hidden');
                }
            } else {
                suggestedTipContainer.classList.add('hidden');
            }
        }

        function openModal(tip) {
            currentTip = tip;
            mainTipView.classList.remove('hidden');
            detailsView.classList.add('hidden');

            const categoryName = tip.category.replace(/_/g, ' & ').replace(/\b\w/g, l => l.toUpperCase());

            modalTitle.innerHTML = `${getIconHtml(tip.category)}${tip.title}`;
            modalCategory.textContent = `Category: ${categoryName}`;
            modalDescription.textContent = tip.description;
            modalSource.textContent = `Source: ${tip.source} | Difficulty: ${tip.difficulty}`;

            copyTipButton.onclick = () => copyTipToClipboard(tip);
            
            if (tip.context) {
                moreInfoButton.style.display = 'inline-flex';
            } else {
                moreInfoButton.style.display = 'none';
            }
            
            displaySuggestedTip(tip);

            tipModal.classList.remove('hidden');
        }

        function showDetailsView() {
            if (!currentTip || !currentTip.context) return;

            mainTipView.classList.add('hidden');
            detailsView.classList.remove('hidden');
            
            const categoryName = currentTip.category.replace(/_/g, ' & ').replace(/\b\w/g, l => l.toUpperCase());

            detailsTitle.innerHTML = `${getIconHtml(currentTip.category)}${currentTip.title}`;
            detailsCategory.textContent = `Category: ${categoryName} | Difficulty: ${currentTip.difficulty}`;
            detailsContent.innerHTML = currentTip.context.replace(/\n/g, '<br><br>');
            
            displayRelatedTipsInModal(currentTip);
            displayGlossaryTermsInModal(currentTip);
        }

        function showMainTipView() {
            detailsView.classList.add('hidden');
            mainTipView.classList.remove('hidden');
        }

        function closeModal() {
            tipModal.classList.add('hidden');
        }

        function copyTipToClipboard(tip) {
            const tipText = `Tip: ${tip.title}\nDifficulty: ${tip.difficulty}\nDescription: ${tip.description}\nSource: ${tip.source}`;
            const textarea = document.createElement('textarea');
            textarea.value = tipText;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                const originalText = copyTipButton.innerHTML;
                copyTipButton.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                setTimeout(() => { copyTipButton.innerHTML = originalText; }, 2000);
            } catch (err) {
                console.error('Failed to copy tip: ', err);
            } finally {
                document.body.removeChild(textarea);
            }
        }

        function generatePdf() {
            const doc = new jsPDF();
            let y = 15;
            const margin = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;

            const addPageIfNeeded = (neededHeight) => {
                if (y + neededHeight > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }
            };

            doc.setFontSize(22);
            doc.text("MPC Vault: The Ultimate Guide", pageWidth / 2, y, { align: 'center' });
            y += 10;
            doc.setFontSize(12);
            doc.text("Comprehensive Tips & Tricks Guide", pageWidth / 2, y, { align: 'center' });
            y += 15;

            let currentCategory = '';
            
            const sortedTips = [...tipsData].sort((a, b) => a.category.localeCompare(b.category));

            sortedTips.forEach((tip) => {
                if (tip.category !== currentCategory) {
                    currentCategory = tip.category;
                    addPageIfNeeded(20);
                    doc.setFontSize(16);
                    doc.setFont(undefined, 'bold');
                    const categoryTitle = currentCategory
                        .replace(/_/g, ' & ')
                        .replace(/\b\w/g, l => l.toUpperCase());
                    doc.text(categoryTitle, margin, y);
                    y += 10;
                }

                const titleText = `${tip.title} (${tip.difficulty})`;
                const descriptionText = tip.description;
                const sourceText = `Source: ${tip.source}`;

                doc.setFontSize(12);
                doc.setFont(undefined, 'bold');
                const titleLines = doc.splitTextToSize(titleText, pageWidth - (2 * margin));
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                const descriptionLines = doc.splitTextToSize(descriptionText, pageWidth - (2 * margin));

                addPageIfNeeded(titleLines.length * 5 + descriptionLines.length * 5 + 10);
                
                doc.setFontSize(12);
                doc.setFont(undefined, 'bold');
                doc.text(titleLines, margin, y);
                y += titleLines.length * 5;

                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text(descriptionLines, margin, y);
                y += descriptionLines.length * 5;

                doc.setFontSize(8);
                doc.setTextColor(150);
                doc.text(sourceText, margin, y);
                doc.setTextColor(0);
                y += 10;
            });

            doc.save('MPC_Vault_Complete_Guide.pdf');
        }
        
        function displayGlossary(searchTerm = '') {
            glossaryContent.innerHTML = '';
            const lowerCaseSearchTerm = searchTerm.toLowerCase().trim();
            const filteredGlossary = glossaryData.filter(item => 
                item.term.toLowerCase().includes(lowerCaseSearchTerm) ||
                item.definition.toLowerCase().includes(lowerCaseSearchTerm)
            );
            
            if (filteredGlossary.length === 0) {
                glossaryContent.innerHTML = '<p>No terms found.</p>';
                return;
            }
            
            filteredGlossary.sort((a, b) => a.term.localeCompare(b.term)).forEach(item => {
                const termElement = document.createElement('div');
                termElement.className = 'glossary-item';
                termElement.innerHTML = `
                    <h4 class="text-2xl font-bold mb-2">${item.term}</h4>
                    <p>${item.definition}</p>
                `;
                glossaryContent.appendChild(termElement);
            });
        }

        function createDrumPattern(container, patternData) {
            const patternContainer = document.createElement('div');
            patternContainer.className = 'mb-6';

            const title = document.createElement('h5');
            title.className = 'text-xl font-semibold mb-2';
            title.textContent = patternData.name;
            patternContainer.appendChild(title);

            const artist = document.createElement('p');
            artist.className = 'text-sm text-gray-400 mb-2';
            artist.textContent = `Style of: ${patternData.artist}`;
            patternContainer.appendChild(artist);

            for (const instrument in patternData.pattern) {
                const instrumentRow = document.createElement('div');
                instrumentRow.className = 'flex items-center gap-2 mb-2';
                const instrumentLabel = document.createElement('div');
                instrumentLabel.className = 'w-20 text-sm font-bold text-right';
                instrumentLabel.textContent = instrument;
                instrumentRow.appendChild(instrumentLabel);

                const grid = document.createElement('div');
                grid.className = 'drum-pattern-grid flex-1';
                
                for (let i = 0; i < 16; i++) {
                    const step = document.createElement('div');
                    step.className = 'drum-step';
                    if (patternData.pattern[instrument].includes(i)) {
                        step.classList.add('active');
                    }
                    grid.appendChild(step);
                }
                instrumentRow.appendChild(grid);
                patternContainer.appendChild(instrumentRow);
            }
            container.appendChild(patternContainer);
        }

        function populateMpcSauce() {
            const container = document.getElementById('drum-patterns-container');
            if (!container) return;
            container.innerHTML = '';
            drumPatterns.forEach(pattern => {
                createDrumPattern(container, pattern);
            });
        }


        // --- EVENT LISTENERS ---
        difficultySortButtons.forEach(button => {
            button.addEventListener('click', () => {
                difficultySortButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentDifficulty = button.dataset.difficulty;
                displayTips(currentCategory, searchInput.value, currentDifficulty);
            });
        });

        const performSearch = () => {
            displayTips(currentCategory, searchInput.value, currentDifficulty);
        };

        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('input', performSearch); // Live search
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        downloadPdfButton.addEventListener('click', generatePdf);
        closeModalButton.addEventListener('click', closeModal);
        tipModal.addEventListener('click', (e) => {
            if (e.target === tipModal) closeModal();
        });

        glossaryButton.addEventListener('click', () => {
            glossaryModal.classList.remove('hidden');
            displayGlossary();
        });
        closeGlossaryModalButton.addEventListener('click', () => glossaryModal.classList.add('hidden'));
        glossaryModal.addEventListener('click', (e) => {
            if (e.target === glossaryModal) glossaryModal.classList.add('hidden');
        });
        glossarySearchInput.addEventListener('input', (e) => displayGlossary(e.target.value));

        mpcSauceButton.addEventListener('click', () => {
            mpcSauceModal.classList.remove('hidden');
        });
        closeMpcSauceModalButton.addEventListener('click', () => mpcSauceModal.classList.add('hidden'));
        mpcSauceModal.addEventListener('click', (e) => {
            if (e.target === mpcSauceModal) mpcSauceModal.classList.add('hidden');
        });

        moreInfoButton.addEventListener('click', showDetailsView);
        backToTipButton.addEventListener('click', showMainTipView);

        // --- INITIALIZATION ---
        populateCategories();
        displayTopTips();
        displayTips(currentCategory, '', currentDifficulty);
        populateMpcSauce();
    });
    </script>
</body>
</html>
